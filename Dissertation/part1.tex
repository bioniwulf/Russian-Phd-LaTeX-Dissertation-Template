\chapter{Обзор современных подходов к решению задачи распределения управляющего воздейвия на ДРК подводных аппаратов} \label{ch:Statement}
\section{Формулировка задачи распределения управляющих воздействий}\label{sec:Statement/ProblemStatement}
Пусть динамика подводного аппарата, оснащенного избыточным ДРК, определена в формулировках метода пространства состояний следующим образом:
\begin{equation}
    \vect{\dot{x}}(t) = a(\vect{x}(t)) + B_u(\vect{x}(t))\vect{u}(t)
\end{equation}
\noindent где:
\begin{itemize}
    \item $\vect{x}(t) \in \mathspace{R}^n$ -- вектор состояния системы;
    \item $\vect{u}(t) \in \mathspace{U} \subset{\mathspace{R}}^k$ -- вектор управления исполнительными механизмами (control input), где подмножество $\mathspace{U}$ можно интерпретировать как ограничение величины команд управления, вызванное насыщением статической характеристики движителей, механическими ограничениями угла поворота рулей или иными особенностями ИМ;
    \item $a(\vect{x}(t)): \mathspace{R}^n \rightarrow \mathspace{R}^n$ -- гладкая нелинейная функция, описывающая управляемую систему;
    \item $B_u(\vect{x}(t)) \in \mathspace{R}^{n \times k}$ -- матрица, определяющая влияние вектора управления на состояние системы.
\end{itemize}
Пусть ранг матрицы $B_u$ равен $m$ и он меньше чем $k$ вследствие избыточности ДРК.
Такая матрица является недоопределённой, а соответствующая ей система либо имеет бесконечное число линейно зависимых решений по параметру $u$, либо не имеет решений вовсе.

Матрица $B_u$ может быть разложена следующим образом:
\begin{equation}
    \label{eq:dynamic_statespace}
    B_u(\vect{x})(t) = B_{\nu}(\vect{x}) B(\vect{x})
\end{equation}
\noindent где обе матрицы $B_{\nu}(\vect{x})$ и $B(\vect{x})$ обладают рангом $m$.
Это ведёт к новому описанию динамической системы \ref{eq:dynamic_statespace}, которое может быть представлено следующим образом:

\begin{gather}
    \label{eq:dynamic_statespace_new}
    \vect{\dot{x}}(t) = a(\vect{x}(t)) + B_{\vec{\nu}}(\vect{x}(t))\vect{\nu}(t) \\
    \vect{\nu}(t) = B(\vect{x}(t))\vect{u}(t)
\end{gather}
\noindent где $\vect{\nu}(t) \in \mathspace{A} \subset \mathspace{R}^n$ можно интерпретировать как обобщенное действие всех исполнительных механизмов на объект управления или вектор виртуального управления (virtual input), а подмножество $\mathspace{A}$ получается аффинным преобразованием из подмножества $\mathspace{U}$ под действием матрицы $B(x)$.

Удобно раскладывать матрицу $B_u$ таким образом, чтобы матрица $B_{\nu}$ была квадратной ($n=m$). При этом матрица будет полноранговой, а решение уравнения для первой части системы \ref{eq:dynamic_statespace_new} единственным. В качестве вектора управления удобно использовать обобщенный вектор сил и моментов, действующих на объект управления в связанной с ним системе координат (ССК). При $n=6$ его можно определить как $\vect{\nu} = [f_x,f_y,f_z,m_x,m_y,m_z]^T$ где $f_x,f_y,f_z$ -- проекции сил затребованных системой управления движением на продольную поперечную и нормальную оси связанной с аппаратом системе координат, а $m_x,m_y,m_z$ -- соответствующие затребованные проекции моментов. 

Тем не менее, матрица $B(\vect{x})$ в случае избыточного ДРК остается недоопределённой. Фактически это ведет к тому что для вектора $\nu_c$, который был затребован системой управления, может быть неопределённое множество решений уравнения \ref{eq:dynamic_statespace_new}.

Задача поиска оптимального вектора управления движением может быть поставлена в рамках обоих вариантов описания системы представленных выше.
Пусть задача оптимального управления поставлена в рамках квадратичной оптимизации, тогда для описания \ref{eq:dynamic_statespace} задача будет сформулирована следующим образом \cite{10.1016/j.automatica.2004.09.007}

\begin{gather}
    \min \int_0^{\infty} \left[ q(x) + u^T R_u(x) u \right] dt \\
    \text{при условии } u \in \mathspace{U} \notag
\end{gather}
\noindent где $q(\vect{x}) \geq 0, R_u(\vect{x}) = R_u^T(\vect{x}) \geq 0$ -- некоторые критерии оптимизации.

При этом описание \ref{eq:dynamic_statespace_new} естественным образом ведет к постановке двух независимых оптимизационных задач, которые могут быть записаны следующим образом:

\begin{gather}
    \min \int_0^{\infty} \left[ q(x) + \nu^T R_{\nu}(x) \nu \right] dt \\
    \min \left( ||Q_s|| + J(\vect{x}, \vect{u}, t) \right) \\
    \text{при условии } \vect{\nu}-B(\vect{x})\vect{u} = \vect{s}, u \in \mathspace{U} \notag
\end{gather}
\noindent где:
\begin{itemize}
    \item $q(\vect{x}) \geq 0, R_{\nu}(\vect{x}) = R_{\nu}^T(\vect{x}) \geq 0$ -- некоторые коэффициенты оптимизации;
    \item $s$ -- невязку вектора виртуального управления, которая определяет меру различия между заданным и сформированным вектором управления;
    \item $Q$ -- матрица, формализующая приоритеты работы тех или иных осей управления при выходе вектора $\nu$ за пределы допустимого множества $\mathspace{A}$.
    \item $J(\vect{x}, \vect{u}, t)$ -- некоторый функционал качества.
\end{itemize}

В работе \cite{10.1016/j.automatica.2004.09.007} показано, что оптимальность решения сохраняется при переходе от задачи оптимизации \ref{eq:dynamic_statespace} к двум независимым задачам \ref{eq:dynamic_statespace_new}. При этом второй подход позволяет достичь следующих преимуществ:
\begin{itemize}
    \item Решение задачи оптимального управления \ref{eq:dynamic_statespace} для нелинейных систем трудоемко и требует значительных численных расчётов, но при этом, в случае неизменного критерия оптимизации $R_{\nu}$ и изменяющихся критериев оптимизации $J(\vect{x}, \vect{u}, t)$ и $Q$, нет необходимости заново получать решение уравнения \ref{eq:dynamic_statespace}.
    \item В первом подходе изменение параметров оптимизации $R_{u}$ влияет как на изменение поведения системы в целом, так и на изменение распределения управляющих команд. Во втором случае задачи изолированы друг от друга и изменение $R_{\nu}$ влияет только на поведение системы, не затрагивая работу ДРК.
    \item Реализация системы управления движением может быть архитектурно разделена на два независимых уровня и в рамках каждого из них могут быть применены различные подходы к решению. При этом важно, что задача управления движением подводного аппарата может быть полностью абстрагирована от структуры его ДРК, обеспечив единый и универсальный подход к разработке контура управления движением для произвольного типа ПА.
    \item Ограничения, накладываемые на общую задачу оптимального управления \ref{eq:dynamic_statespace}, существенно усложняют её численное решение, особенно когда подмножество   является невыпуклым. При раздельном подходе можно решать задачу \ref{eq:dynamic_statespace_new}, условно считая задачу без ограничений, при этом накладывая ограничения только на более простую задачу, решение которой с учётом ограничений технически реализуемо современными вычислительными средствами в режиме реального времени.
    \item Реализация раздельных уровней управления движением позволяет существенно упростить систему аккомодации за счет её переноса в область ответственности задачи распределения управляющих команд.
\end{itemize}

Отдельно стоит упомянуть случай при $k-n < 0$ для системы \ref{eq:dynamic_statespace}. Такой случай подразумевает, что исполнительных механизмов ДРК меньше чем размерность вектора состояния системы, такие системы можно назвать дефицитными (under-actuated system), а соответствующие ей матрица $B_u$ является переопределённой или плохо обусловленной. В этом случае задача распределения управляющего воздействия тесно связана с системой управления движением ПА, и её сложно сформулировать обособленно. Отдельные примеры решения этой задачи для различных типов АНПА представлены в литературе \cite{10.1049/iet-cta.2009.0265, 10.1109/cdc.2002.1184546}.

\section{Методы решения задачи распределения управляющих воздействий}\label{sec:Statement/Methods}
Существует достаточно много подходов к постановке и решению задачи распределения управляющих воздействий между ИМ ДРК.
В рамках данного обзора они разделены на две большие группы.
В первую группу отнесены те задачи, в которых вектор виртуального управления пропорционален вектору управления ИМ, то есть $\vect{\nu}(t) = B \vect{u}(t)$, и это допущение было сделано в формулировке задачи распределения управляющими воздействиями. Но в то же время существует отдельная группа систем, где это допущение не может быть принято.
\subsection{Линейные системы ИМ}

В подавляющем большинстве случаев к этой группе относят практически все телеуправляемые необитаемые подводные аппараты (ТНПА) с фиксированными движителями, а также большая часть АНПА оснащенных фиксированными движителями и/или рулями управления.
В статье \cite{yuh2000design} представлен обзор различных АНПА разработанных до 2000-го года за рубежом.
Большинство представленных аппаратов оснащено одним или двумя маршевыми движителями, которые работают совместно с рулями управления.
К этой группе также могут быть отнесены такие аппараты как «МТ-2010» \cite{борейко2011малогабаритный}, «ММТ-3000» \cite{горнак2007ммт} и другие аппараты разработанные в Институте проблем морских технологий ДВО РАН.

Для линейных систем исполнительных механизмов исторически первыми появились статические модели, описывающие их поведение, и соответствующие им статические методы оптимизации, но после 2000-го года начали появляться исследования, в рамках которых учитывалась динамическая модель исполнительных механизмов при решении задачи оптимального распределения.

\subsubsection{Аналитическое решение при $\vect{u} \in \mathspace{R}^k$}
Отдельным случаем является аналитическое решение задачи при отсутствии ограничений на управляющие команды, т.е. $\vect{u} \in \mathspace{R}^k$.
Такая ситуация отчасти является синтетической, но может быть к ней сведена подбором специальных контуров управления с затяжными переходными процессами.
При отсутствии ограничений на команды управления, оптимизационная задача может быть на основе метрики $L_2$ (евклидова норма):
\begin{gather}
    \min \frac{1}{2}(\vect{u} - \vect{u_p})W(\vect{u} - \vect{u_p}) \\
    \text{при } \vect{\nu}_c = B\vect{u} \notag
\end{gather}
\noindent где $\vect{u_p}$ -- желаемое значение вектора управления ИМ в случае отсутствия управления, а $W$ -- диагональная матрица положительно определённых весовых коэффициентов.

Решение данной задачи может быть получено аналитическим образом и имеет следующий вид \cite{fossen1991adaptive}:
\begin{equation}
    \vect{u} = (I-CB)\vect{u}_p + C \nu_c
\end{equation}
\noindent где $I$ -- единичная матрица, а матрица $C$ определяется следующим выражением:
\begin{equation}
    C = W^{-1}B^T(BW^{-1}B^T)^{-1}
\end{equation}

Это решение возможно только если матрица $B$ является невырожденной, но зачастую, это не так или она может стать вырожденной при отказах отдельных элементов движительно-рулевого комплекса. В этом случае в практической реализации нормальной является практика записи матрицы $C$ в следующей форме:
\begin{equation}
    \label{eq:allocation_unbound}
    C_{\epsilon} = W^{-1} B^T (BW^{-1}B^T + \epsilon I)^{-1}
\end{equation}
\noindent где $\epsilon \geq 0$ представляет собой бесконечно малую добавку фактически не влияющую на решение задачи, но обеспечивающую существование обратной матрицы.

\subsubsection{Прямое распределение с масштабированием}
Данный подход не обеспечивает оптимального решения, но позволяет получить его в условиях линейных ограничений $\vect{u} \in \mathspace{U} \subset \mathspace{R}^k$ накладываемых на исполнительные механизмы.
Данный метод подразумевает поиск такого набора линейных положительных сжимающих коэффициентов $\vect{\alpha} \in [0,1]$, при котором решение задачи распределения управляющего воздействия не выходит за рамки допустимого множества $\mathspace{U}$ \cite{durham1993constrained}, при этом новая линейная оптимизационная задача ставится следующим образом:
\begin{gather}
    \max \vect{\alpha} \\
    \text{при условии } B\vect{u} = \vect{\alpha} \vect{\nu_c}, \vect{\alpha} \vect{\nu_c} \in \mathspace{A}
\end{gather}

Решение задачи поиска такого набора сжимающих коэффициентов встречается в зарубежной литературе \cite{bordingnon1995closed, petersen2002fast}.

Одна из вариаций данного подхода, которая используется в аппаратах Института проблем морских технологий ДВО РАН формулируется следующим образом \cite{костенко2015вопросу}.
Пусть $\nu_c^{prio}$ представляет собой команду управления $\nu_c$ в которой оси расставлены в соответствии с уменьшением степени приоритета, $l=[l_1,l_2, \ldots, l_m]$ где $l_i \in [0,1]$ представляет собой набор коэффициентов насыщения $i$-ой оси управления, а $u^{ub}$ представляет собой решение задачи распределения без ограничений, полученное в соответствии с выражением \ref{eq:allocation_unbound}. Тогда можно решить задачу распределения управляющих значений итерационным методом с фиксированным количеством шагов. Так для оси с максимальным приоритетом, т.е. для $v_c^1$ сжимающий коэффициент будет записан следующим образом:
\begin{equation}
    \alpha_1 = \min \left\{ \frac{l_1 \cdot u_j^{lim}}{u_j^{ub}} \right\}_{j=1}^k
\end{equation}
\noindent где $u_j^{lim}$ представляет собой максимальный значение команды управления $j$-го исполнительного механизма. Для простоты, считаем что характеристика  исполнительного механизма симметрична, т.е. $u_j^{lim} = u_j^+ = u_j^-$

Для осей с меньшим приоритетом, т.е. для $i>1$ в наборе $\nu_c^{prio}$, расчёт сжимающего коэффициента будет записан следующим образом:
\begin{equation}
    \alpha_i = \min \left\{ \frac{\min (l_1 \cdot u_j^{lim}, u_j^{lim} - u_j^{prev})}{u_j^{ub}} \right\}_{j=1}^k
\end{equation}
\noindent где $u_j^{prev}$ представляет собой команду управления, которая была рассчитана для $j$-го исполнительного механизма на предыдущих итерациях алгоритма расчёта и определяется следующим образом:
\begin{equation}
    u_j^{prev} = \sum_{k=0}^{i-1} \alpha_k u_k^{ub}
\end{equation}

\subsubsection{Квадратичная оптимизация}
Выбор функционала   второго порядка в уравнении описывающем управляемую систему \ref{eq:dynamic_statespace_new} можно легко привести к записи задачи квадратичной оптимизации в каноничной форме (метрика $L_2$ или евклидова норма):
\begin{equation}
    \min_{u,s} \frac{1}{2}\left(\vect{u^T}, \vect{s^T}\right) H 
    \begin{pmatrix}
        \vect{u} \\
        \vect{s}
    \end{pmatrix}
\end{equation}
\noindent где $H = 2 \cdot diag(q_1,\ldots,q_k, w_1,\ldots,w_m)$ представляет собой диагональную матрицу положительно определённых весовых коэффициентов для ИМ ДРК ($q_1,\ldots,q_k$) и элементов вектора виртуального управления ($w_1,\ldots,w_m$).

В данной постановке задачи используются различные математические методы поиска решения, например, метод активного набора (active set) или метод внутренней точки (interior point).
Оба метода использовались при решении задачи распределения для квадратичной формулировки проблемы \cite{petersen2005constrained, harkegard2002efficient}.
Функционал $J$ может быть записан также и в $L_1$ метрике, но особенностью методов линейного программирования при решении таких задач является поиск оптимального решения по граням и вершинам области допустимых значений границ подмножества $\mathspace{U}$. 
Физический смысл этого заключается в тенденции максимальной загрузки минимального количества ИМ \cite{bodson2002evaluation}, что существенно повышает износ отдельных ИМ и ведёт к чрезмерной нагрузке на систему энергообеспечения. В то время как методы квадратичного программирования, в свою очередь, стремятся найти такое решение, которое распределяет равную нагрузку на максимальное количество элементов управления.

\subsubsection{Динамическое распределение}
Предыдущие формулировки задачи распределения вектора управления строились на базе статической модели ИМ и не учитывали динамических процессов, которые происходят в них.
В работах \cite{10.2514/1.11607, 10.1016/j.automatica.2008.03.031} были предложены первые попытки формулировки задачи распределения вектора управления с учетом динамики ИМ.

В работе \cite{10.1016/j.automatica.2009.01.013} представлен новый подход для учета динамики исполнительных приводов. Его суть заключается в создании подпространств глобального пространства решения задачи распределения управляющих команд, которые отражают «виртуальную» динамику процессов, происходящих в исполнительных механизмах. Позже этот подход был развит в работах \cite{10.1016/j.automatica.2014.10.112, 10.1109/cdc.2012.6426209}.

В рамках нового подхода, динамическая задача распределения управляющих воздействий (dynamic control allocation) приобрела новую формальную запись:

\begin{equation}
    \left\{
    \begin{matrix*}[l]
    \dot{\vect{\omega}}(t) = \vect{\mu}(t) \\
    \vect{u}(t) = B^+\vect{\nu}(t) + B_{\perp} \dot{\vect{\omega}}(t), \vect{u}_c(t) \equiv B^+\vect{\nu}(t)
    \end{matrix*}
    \right.
\end{equation}
\noindent где
\begin{itemize}
    \item $\vect{\omega}(t) \in \mathspace{R}^{k-m}$ -- вектор состояния распределителя (allocator state);
    \item $\vect{\mu}(t)$ -- вход распределителя (allocator input);
    \item $\vect{u}_c(t)$ -- первичный вектор управления ИМ;
    \item $B^+$ -- псевдообратная матрица к матрице $B$;
    \item $B_{\perp}$ --  представляет собой такую недоопределённую матрицу множество решений которой формируют подпространство ортогональное подпространству сформированному множеством решений недоопределённой матрицы $B$.
\end{itemize}

Такая запись позволяет получить произвольный вектор команд управления ИМ путем настройки $\vect{\omega}(t)$.

Недостатком методов, представленных выше, является необходимость знания модели исполнительных механизмов. Для решения этой проблемы в работе \cite{10.1016/j.automatica.2020.109265} авторами представлен новый подход, в котором параметры динамики ИМ определяются в режиме реального времени на основе методов обучения с подкреплением.

\subsubsection{Динамическое распределение на базе прогнозирующих моделей}
Управление с прогнозирующими моделями (Model predictive control) представляет собой один из самых современных подходов в области теории управления. 
Изначально он применялся при управлении производственными процессами, где большие постоянные времени переходных процессов позволяли его применять, т.к. он крайне ресурсоёмок.
Но с ростом вычислительных мощностей компьютеров и встраиваемых систем появилась возможность применения данного подхода для мобильных объектов управления. В рамках этого подхода сформировался отдельных подкласс под названием «Model predictive control allocation» \cite{10.1016/j.ifacol.2019.08.065, 10.1016/j.ifacol.2015.10.048, 10.1007/s11768-019-7231-9} предназначенный для решения задачи распределения управляющих воздействий на основе прогнозирующих моделей.

Задача распределения в данном подходе записывается следующим образом \cite{10.1109/icca.2011.6137940}. Пусть исполнительные механизмы ДРК представлены в формулировках метода пространства состояний следующим образом:

\begin{equation}
    \dot{\vect{u}}(t) = A_u\vect{u}(t) + B_u \vect{u}_{cmd}(t)
\end{equation}
\noindent где:
\begin{itemize}
    \item $A$ и $B$ -- блочно-диагональные матрицы описывающие динамику исполнительных элементов;
    \item $\vect{u}_{cmd}(t)$ -- вектор управления ИМ;
    \item $\dot{\vect{u}}(t)$ -- управление сформированное ИМ.
\end{itemize}

Тогда постановка задачи распределения управления на базе прогнозирующей модели будет выглядеть следующим образом:

\begin{equation}
\begin{matrix*}[c]
    \dot{\vect{u}}(t) = A_u\vect{u}(t) + B_u\vect{u}_{cmd}(t) \\
    \text{при условии} \\
    \vect{\nu}_c(t) = B \vect{u}(t), \vect{u} \in \mathspace{U}
\end{matrix*}
\end{equation}

Для предсказания состояния на горизонт времени $N$ набора исполнительных механизмов $\vect{u}(t)$ используется дискретная запись:
\begin{equation}
    \begin{matrix*}[c]
    \widehat{\vect{u}} = \left[ \widehat{\vect{u}}(k+1|k), \dots, \widehat{\vect{u}}(k+N|k)) \right] \\
    \end{matrix*}
\end{equation}

где $N$ представляет собой размер горизонта предсказания, а $k$  текущий временной отрезок.
Для заданного горизонта предсказания множество решений вектора управления ИМ ДРК $u_{cmd}^*$ может быть найдено путем минимизации квадратичного функционала, который записан следующим образом:
\begin{eqnarray}
    J(\cdot) = \sum_{j=1}^N W(j) \left[ \widehat{\vect{\nu}}(k+j|k) - \vect{\nu^{*}}(k+j) \right]^2 + \notag \\ 
    + \sum_{j=1}^{N-1} \sum_{i=1}^{k}W_a(i)\left[ \vect{u}_{cmd,i}(k+j-1|k) \right]^2
\end{eqnarray}

где $W{j}$ представляет собой матрицу весовых коэффициентов которая отражает значимость минимизации невязки с целевой командой управления $\vect{\nu}^*$ в момент времени $j$. В свою очередь весовой коэффициент $W_a(i)$ отражает стоимость использования $i$-го исполнительного механизма.

\subsection{Нелинейные системы ИМ}

Существуют более сложные системы ДРК, так например в экспериментальном автономном подводном аппарате «KAUV-1» \cite{10.1007/s12555-012-0385-6} маршевый движитель расположен на поворотной платформе, которая обеспечивает его вращение в горизонтальной плоскости ССК, в то время как система изменяемого положения центра масс обеспечивает создание момента по каналу дифферента.
Еще одним примером сложного движительно-рулевого комплекса является автономный подводный аппарат «Jinbei» \cite{10.1109/oceans-yeosu.2012.6263496} на котором установлена пара вращательных подруливающих движителей.
Похожий автономный робототехнический комплекс под названием «Otohime» \cite{10.1109/oceans-yeosu.2012.6263498} так же оснащен поворотными подруливающими движителями и был разработан той же группой японских ученых для решения задачи автоматического сбора грунта с морского дна.

Особенностью таких структур ДРК является наличие движителей, которые закреплены на поворотной платформе.
Это ведёт к тому что допущение $\vect{\nu}(t)=B\vect{u}(t)$ не может быть принято.
Кроме того, в этом случае область решения является невыпуклой. 
Для такого класса задачи подавляющая часть методов описанные выше не работают и требуются другие подходы.
\subsubsection{Методы нелинейного программирования}
В работах \cite{10.1109/tcst.2003.821952, poonamallee2004nonlinear} показано, что методы нелинейного программирования можно использовать для решения задачи распределения управляющих воздействий.
Основным используемым подходом является локальная аппроксимация квадратичного функционала и линеаризация ограничений. 

Это приводит к численному методу решения оптимизационной задачи, аналогичному последовательному квадратичному программированию (Sequential quadratic programming), за исключением того, что линейное либо квадратичное приближение необходимо выполнять для каждой итерации расчётов.

Недостатком такого подхода является то, что при высокой нелинейности исполнительных механизмов и сильной невыпуклости области решения данный метод может остаться в локальном экстремуме, не дойдя до глобального, что может существенно ухудшить качество управления.

\subsubsection{Динамический поиск оптимума}
В работе \cite{10.1109/cdc.2004.1429240} автором предлагается переформулировать задачу поиска оптимального распределения управляющего воздействия как поиск управляющей функции Ляпунова. В частности, пусть задан функционал $J'(\vect{x}, \vect{u}, t) = J(\vect{x}, \vect{u}, t) + \delta(\vect{u})$, где $\delta(\vect{u})$ представляет собой специальную штрафную функцию которая удерживает $\vect{u}$ в рамках подпространства $\mathspace{U}$. Тогда функция Ляпунова будет записана следующим образом:
\begin{equation}
    L(\vect{x}, \vect{u}, t, \lambda) = J'(\vect{x}, \vect{u}, t) + \lambda^T(\nu_c - h(\vect{u},\vect{x},t))
\end{equation}
\noindent где $\lambda$ -- множитель Лагранжа.

Пусть существует функция управления Ляпунова $V_0(\vect{x},t)$ (Control-Lyapunov function) которая была сформирована системой управления НПА, тогда задача оптимального распределения управляющего воздействия при этом подходе будет записана следующим образом:
\begin{equation}
    V(\vect{x}, \vect{u}, t, \lambda) = \sigma V_0(\vect{x}, t) + \frac{1}{2}
    \left(
    \frac{\partial L^T}{\partial \vect{u}} \frac{\partial L}{\partial \vect{u}} 
    + \frac{\partial L^T}{\partial \lambda} \frac{\partial L}{\partial \lambda}
    \right)
\end{equation}
\noindent где $\sigma$ -- некоторый множитель.

Этот подход был развит позже для задачи распределения управляющих воздействий для нелинейных ИМ с учетом их динамики \cite{10.4173/mic.2008.2.4}.
\section{Программные средства для решения задачи распределения управляющих воздействий}
Для решения задачи оптимизации распределения управляющего воздейсвия во встраиваемых системах управления, используемых в подводных аппаратах желательно использовать легковесные библиотеки на языках программирования С++/С, которые позволяют решать оптимизационные задачи в режиме реального времени и легко встраиваемы в ПО аппарата.

Основные известные программные реализации с открытым исходным кодом которые подходят для описываемой задачи следующие:
\begin{itemize}
    \item CVXGEN -- реализация решения задачи квадратичной оптимизации на основе метода внутренней точки с автоматической генерацией С кода \cite{mattingley2010real}. В работе \cite{10.1109/icca.2011.6137940} показано что этот программный пакет может быть использован для решения задачи оптимального распределения в формулировках MPC подхода в режиме реального времени.
    \item qpOASES -- реализация решения задачи квадратичной оптимизации на основе метода активных множеств на языке С++ \cite{ferreau2014qpoases}.
    \item FiOrdOs -- специальный программный модуль к MATLAB, который позволяет автоматически сформировать код для численного решения задачи квадратичной оптимизации с линейными ограничениями на языке С. Может быть использован для решения задачи оптимального распределения в формулировках MPC \cite{jones2012fast}.
    \item ACADO -- специальная программная среда и набор алгоритмов для решения задачи квадратичной оптимизации с ограничениями, динамической оптимизации, задачи MPC. В составе пакета есть специальные методы для автоматической генерации С кода \cite{houska2011acado}.
    \item MPT (Multi-Parametric Toolbox) -- специальный бесплатный пакет к MATLAB включающий в себя реализацию оптимального управления линейными, гибридными и нелинейными системами. Может быть задан линейный и квадратичный функционал качества. Есть автоматическая генерация кода на языке С \cite{kvasnica2004multi}.
\end{itemize}

\section{Постановка цели и задач исследования}\label{sec:Statement/SetProblems}

Задачу управления движением подводного аппарата можно ставить различными способами.
Один из них заключается в разделении задачи на две независимых, которые решаются последовательно: управление движением НПА и управление исполнительными механизмами.
Показано, что при такой декомпозиции управления оптимальность решения сохраняется.
В главе приведены различные подходы и методы решения задачи распределения управляющих воздействий в зависимости от типа используемого ДРК.
Кроме того, представлены программные пакеты, которые позволяют реализовать рассмотренные подходы в компьютерах и встраиваемых системах. 

Описываемая задача представляется достаточно проработанной, но в тоже время существует большой пласт особенностей динамики ИМ, которые до сих пор не учтены в представленных подходах:
\begin{itemize}
    \item при формировании динамических моделей исполнительных механизмов явным образом не выражены параметры электроприводов. В работах не учитывается, что коэффициент полезного действия электромотора существенно зависит от скорости вращения вала привода;
    \item динамическая модель ИМ не учитывает сильную зависимость параметров исполнительных механизмов от скорости набегающего потока, хотя это важный параметр для работы всех исполнительных механизмов. Так например в работе \cite{palmer2008modelling} показано что из-за гидродинамических особенностей эффективность ПА существенно падает с возрастанием скорости набегающего потока.
\end{itemize}

\textbf{Целью диссертационной работы} является разработка методов энергоэффективного и отказоустойчивого управления избыточным движительно-рулевым комплексом подводного аппарата с учётом динамики исполнительных механизмов и их гидродинамических особенностей.

Для~достижения поставленной цели необходимо было решить следующие {\tasks}:
\begin{enumerate}[beginpenalty=10000] % https://tex.stackexchange.com/a/476052/104425
  \item изучить модели описания исполнительных механизмов (маршевые движители, подруливающие движители, рули управления) ДРК подводного аппарата учитывающие особенности их поведения в набегающем потоке;
  \item разработать метод формального описания, анализа и реконфигурации в режиме реального времени ДРК оснащенного произвольным набором исполнительных механизмов;
  \item разработать и реализовать дублирующий метод определения скорости набегающего потока по параметрам работы электроприводов маршевых движителей;
  \item разработать и реализовать энергетически оптимальный отказоустойчивый метод распределения управляющих воздействий для АНПА устойчивый к неполному знанию скорости набегающего потока;
  \item разработать и реализовать метод плавного перераспределения управляющего воздействия при переходах между различными типами движения;
  \item провести проверку эффективности разработанного метода распределения управляющих воздействий на базе модельных экспериментов.
\end{enumerate}

\section{Выводы по главе 1}\label{sec:Statement/Conclusion}
В первой главе приводится обзор современных методов и подхов к решению задачи распределения управляющего воздействия на исполнительные механизмы ДРК подводного аппарата.

Отмечено, что хоть тема достаточно проработана, но в работах почти никак не фигурируют гидродинамические особенности работы исполнительных механизмов в набегающем потоке и уменьшение их результирующей силы, что будет детально рассмотрено в следующих главах диссертации.

На основе проведенного анализа сформулированы цель и поставлены задачи диссертационного исследования.
% \chapter{Оформление различных элементов}\label{ch:ch1}

% \section{Форматирование текста}\label{sec:ch1/sec1}

% Мы можем сделать \textbf{жирный текст} и \textit{курсив}.

% \section{Ссылки}\label{sec:ch1/sec2}

% Сошлёмся на библиографию.
% Одна ссылка: \cite[с.~54]{Sokolov}\cite[с.~36]{Gaidaenko}.
% Две ссылки: \cite{Sokolov,Gaidaenko}.
% Ссылка на собственные работы: \cite{vakbib1, confbib2}.
% Много ссылок: %\cite[с.~54]{Lermontov,Management,Borozda} % такой «фокус»
% %вызывает biblatex warning относительно опции sortcites, потому что неясно, к
% %какому источнику относится уточнение о страницах, а bibtex об этой проблеме
% %даже не предупреждает
% \cite{Lermontov, Management, Borozda, Marketing, Constitution, FamilyCode,
%     Gost.7.0.53, Razumovski, Lagkueva, Pokrovski, Methodology, Berestova,
%     Kriger}%
% \ifnumequal{\value{bibliosel}}{0}{% Примеры для bibtex8
%     \cite{Sirotko, Lukina, Encyclopedia, Nasirova}%
% }{% Примеры для biblatex через движок biber
%     \cite{Sirotko2, Lukina2, Encyclopedia2, Nasirova2}%
% }%
% .
% И~ещё немного ссылок:~\cite{Article,Book,Booklet,Conference,Inbook,Incollection,Manual,Mastersthesis,
%     Misc,Phdthesis,Proceedings,Techreport,Unpublished}
% % Следует обратить внимание, что пробел после запятой внутри \cite{}
% % обрабатывается ожидаемо, а пробел перед запятой, может вызывать проблемы при
% % обработке ссылок.
% \cite{medvedev2006jelektronnye, CEAT:CEAT581, doi:10.1080/01932691.2010.513279,
%     Gosele1999161,Li2007StressAnalysis, Shoji199895, test:eisner-sample,
%     test:eisner-sample-shorted, AB_patent_Pomerantz_1968, iofis_patent1960}%
% \ifnumequal{\value{bibliosel}}{0}{% Примеры для bibtex8
% }{% Примеры для biblatex через движок biber
%     \cite{patent2h, patent3h, patent2}%
% }%
% .

% \ifnumequal{\value{bibliosel}}{0}{% Примеры для bibtex8
% Попытка реализовать несколько ссылок на конкретные страницы
% для \texttt{bibtex} реализации библиографии:
% [\citenum{Sokolov}, с.~54; \citenum{Gaidaenko}, с.~36].
% }{% Примеры для biblatex через движок biber
% Несколько источников (мультицитата):
% % Тут специально написано по-разному тире, для демонстрации, что
% % применение специальных тире в настоящий момент в biblatex приводит к непоказу
% % "с.".
% \cites[vii--x, 5, 7]{Sokolov}[v"--~x, 25, 526]{Gaidaenko}[vii--x, 5, 7]{Techreport},
% работает только в \texttt{biblatex} реализации библиографии.
% }%

% Ссылки на собственные работы:~\cite{vakbib1, confbib1}.

% Сошлёмся на приложения: Приложение~\cref{app:A}, Приложение~\cref{app:B2}.

% Сошлёмся на формулу: формула~\cref{eq:equation1}.

% Сошлёмся на изображение: рисунок~\cref{fig:knuth}.

% Стандартной практикой является добавление к ссылкам префикса, характеризующего тип элемента.
% Это не является строгим требованием, но~позволяет лучше ориентироваться в документах большого размера.
% Например, для ссылок на~рисунки используется префикс \textit{fig},
% для ссылки на~таблицу "--- \textit{tab}.

% В таблице \cref{tab:tab_pref} приложения~\cref{app:B4} приведён список рекомендуемых
% к использованию стандартных префиксов.

% В некоторых ситуациях возникает необходимость отойти от требований ГОСТ по оформлению ссылок на
% литературу.
% В таком случае можно воспользоваться дополнительными опциями пакета \verb+biblatex+.

% Например, в ссылке на книгу~\cite{sobenin_kdv} использование опции \verb+maxnames=4+ позволяет
% вывести имена всех четырёх авторов.
% По ГОСТ имена последних трёх авторов опускаются.

% Кроме того, часто возникают проблемы с транслитерованными инициалами. Некоторые буквы русского
% алфавита по правилам транслитерации записываются двумя буквами латинского алфавита (ю-yu, ё-yo и
% т.д.).
% Такие инициалы \verb+biblatex+ будет сокращать до одной буквы, что неверно.
% Поправить его работу можно использовав опцию \verb+giveninits=false+.
% Пример использования этой опции можно видеть в ссылке~\cite{initials}.

% \section{Формулы}\label{sec:ch1/sec3}

% Благодаря пакету \textit{icomma}, \LaTeX~одинаково хорошо воспринимает
% в~качестве десятичного разделителя и запятую (\(3,1415\)), и точку (\(3.1415\)).

% \subsection{Ненумерованные одиночные формулы}\label{subsec:ch1/sec3/sub1}

% Вот так может выглядеть формула, которую необходимо вставить в~строку
% по~тексту: \(x \approx \sin x\) при \(x \to 0\).

% А вот так выглядит ненумерованная отдельностоящая формула c подстрочными
% и надстрочными индексами:
% \[
%     (x_1+x_2)^2 = x_1^2 + 2 x_1 x_2 + x_2^2
% \]

% Формула с неопределенным интегралом:
% \[
%     \int f(\alpha+x)=\sum\beta
% \]

% При использовании дробей формулы могут получаться очень высокие:
% \[
%     \frac{1}{\sqrt{2}+
%         \displaystyle\frac{1}{\sqrt{2}+
%             \displaystyle\frac{1}{\sqrt{2}+\cdots}}}
% \]

% В формулах можно использовать греческие буквы:
% %Все \original... команды заранее, ради этого примера, определены в Dissertation\userstyles.tex
% \[
%     \alpha\beta\gamma\delta\originalepsilon\epsilon\zeta\eta\theta%
%     \vartheta\iota\kappa\varkappa\lambda\mu\nu\xi\pi\varpi\rho\varrho%
%     \sigma\varsigma\tau\upsilon\originalphi\phi\chi\psi\omega\Gamma\Delta%
%     \Theta\Lambda\Xi\Pi\Sigma\Upsilon\Phi\Psi\Omega
% \]
% \[%https://texfaq.org/FAQ-boldgreek
%     \boldsymbol{\alpha\beta\gamma\delta\originalepsilon\epsilon\zeta\eta%
%         \theta\vartheta\iota\kappa\varkappa\lambda\mu\nu\xi\pi\varpi\rho%
%         \varrho\sigma\varsigma\tau\upsilon\originalphi\phi\chi\psi\omega\Gamma%
%         \Delta\Theta\Lambda\Xi\Pi\Sigma\Upsilon\Phi\Psi\Omega}
% \]

% Для добавления формул можно использовать пары \verb+$+\dots\verb+$+ и \verb+$$+\dots\verb+$$+,
% но~они считаются устаревшими.
% Лучше использовать их функциональные аналоги \verb+\(+\dots\verb+\)+ и \verb+\[+\dots\verb+\]+.

% \subsection{Ненумерованные многострочные формулы}\label{subsec:ch1/sec3/sub2}

% Вот так можно написать две формулы, не нумеруя их, чтобы знаки <<равно>> были
% строго друг под другом:
% \begin{align}
%     f_W & =  \min \left( 1, \max \left( 0, \frac{W_{soil} / W_{max}}{W_{crit}} \right)  \right), \nonumber \\
%     f_T & =  \min \left( 1, \max \left( 0, \frac{T_s / T_{melt}}{T_{crit}} \right)  \right), \nonumber
% \end{align}

% Выровнять систему ещё и по переменной \( x \) можно, используя окружение
% \verb|alignedat| из пакета \verb|amsmath|. Вот так:
% \[
% |x| = \left\{
% \begin{alignedat}{2}
%     &&x, \quad &\text{eсли } x\geqslant 0 \\
%     &-&x, \quad & \text{eсли } x<0
% \end{alignedat}
% \right.
% \]
% Здесь первый амперсанд (в исходном \LaTeX\ описании формулы) означает
% выравнивание по~левому краю, второй "--- по~\( x \), а~третий "--- по~слову
% <<если>>. Команда \verb|\quad| делает большой горизонтальный пробел.

% Ещё вариант:
% \[
%     |x|=
%     \begin{cases}
%         \phantom{-}x, \text{если } x \geqslant 0 \\
%         -x, \text{если } x<0
%     \end{cases}
% \]

% Кроме того, для  нумерованных формул \verb|alignedat| делает вертикальное
% выравнивание номера формулы по центру формулы. Например, выравнивание
% компонент вектора:
% \begin{equation}
%     \label{eq:2p3}
%     \begin{alignedat}{2}
%         {\mathbf{N}}_{o1n}^{(j)} = \,{\sin} \phi\,n\!\left(n+1\right)
%         {\sin}\theta\,
%         \pi_n\!\left({\cos} \theta\right)
%         \frac{
%         z_n^{(j)}\!\left( \rho \right)
%         }{\rho}\,
%         &{\boldsymbol{\hat{\mathrm e}}}_{r}\,+   \\
%         +\,
%         {\sin} \phi\,
%         \tau_n\!\left({\cos} \theta\right)
%         \frac{
%         \left[\rho z_n^{(j)}\!\left( \rho \right)\right]^{\prime}
%         }{\rho}\,
%         &{\boldsymbol{\hat{\mathrm e}}}_{\theta}\,+   \\
%         +\,
%         {\cos} \phi\,
%         \pi_n\!\left({\cos} \theta\right)
%         \frac{
%         \left[\rho z_n^{(j)}\!\left( \rho \right)\right]^{\prime}
%         }{\rho}\,
%         &{\boldsymbol{\hat{\mathrm e}}}_{\phi}\:.
%     \end{alignedat}
% \end{equation}

% Ещё об отступах. Иногда для лучшей <<читаемости>> формул полезно
% немного исправить стандартные интервалы \LaTeX\ с учётом логической
% структуры самой формулы. Например в формуле~\cref{eq:2p3} добавлен
% небольшой отступ \verb+\,+ между основными сомножителями, ниже
% результат применения всех вариантов отступа:
% \begin{align*}
%     \backslash!             & \quad f(x) = x^2\! +3x\! +2         \\
%     \mbox{по-умолчанию}     & \quad f(x) = x^2+3x+2               \\
%     \backslash,             & \quad f(x) = x^2\, +3x\, +2         \\
%     \backslash{:}           & \quad f(x) = x^2\: +3x\: +2         \\
%     \backslash;             & \quad f(x) = x^2\; +3x\; +2         \\
%     \backslash \mbox{space} & \quad f(x) = x^2\ +3x\ +2           \\
%     \backslash \mbox{quad}  & \quad f(x) = x^2\quad +3x\quad +2   \\
%     \backslash \mbox{qquad} & \quad f(x) = x^2\qquad +3x\qquad +2
% \end{align*}

% Можно использовать разные математические алфавиты:
% \begin{align}
%     \mathcal{ABCDEFGHIJKLMNOPQRSTUVWXYZ} \nonumber  \\
%     \mathfrak{ABCDEFGHIJKLMNOPQRSTUVWXYZ} \nonumber \\
%     \mathbb{ABCDEFGHIJKLMNOPQRSTUVWXYZ} \nonumber
% \end{align}

% Посмотрим на систему уравнений на примере аттрактора Лоренца:

% \[
% \left\{
% \begin{array}{rl}
%     \dot x = & \sigma (y-x)  \\
%     \dot y = & x (r - z) - y \\
%     \dot z = & xy - bz
% \end{array}
% \right.
% \]

% А для вёрстки матриц удобно использовать многоточия:
% \[
%     \left(
%         \begin{array}{ccc}
%             a_{11} & \ldots & a_{1n} \\
%             \vdots & \ddots & \vdots \\
%             a_{n1} & \ldots & a_{nn} \\
%         \end{array}
%     \right)
% \]

% \subsection{Нумерованные формулы}\label{subsec:ch1/sec3/sub3}

% А вот так пишется нумерованная формула:
% \begin{equation}
%     \label{eq:equation1}
%     e = \lim_{n \to \infty} \left( 1+\frac{1}{n} \right) ^n
% \end{equation}

% Нумерованных формул может быть несколько:
% \begin{equation}
%     \label{eq:equation2}
%     \lim_{n \to \infty} \sum_{k=1}^n \frac{1}{k^2} = \frac{\pi^2}{6}
% \end{equation}

% Впоследствии на формулы~\cref{eq:equation1, eq:equation2} можно ссылаться.

% Сделать так, чтобы номер формулы стоял напротив средней строки, можно,
% используя окружение \verb|multlined| (пакет \verb|mathtools|) вместо
% \verb|multline| внутри окружения \verb|equation|. Вот так:
% \begin{equation} % \tag{S} % tag - вписывает свой текст
%     \label{eq:equation3}
%     \begin{multlined}
%         1+ 2+3+4+5+6+7+\dots + \\
%         + 50+51+52+53+54+55+56+57 + \dots + \\
%         + 96+97+98+99+100=5050
%     \end{multlined}
% \end{equation}

% Уравнения~\cref{eq:subeq_1,eq:subeq_2} демонстрируют возможности
% окружения \verb|\subequations|.
% \begin{subequations}
%     \label{eq:subeq_1}
%     \begin{gather}
%         y = x^2 + 1 \label{eq:subeq_1-1} \\
%         y = 2 x^2 - x + 1 \label{eq:subeq_1-2}
%     \end{gather}
% \end{subequations}
% Ссылки на отдельные уравнения~\cref{eq:subeq_1-1,eq:subeq_1-2,eq:subeq_2-1}.
% \begin{subequations}
%     \label{eq:subeq_2}
%     \begin{align}
%         y & = x^3 + x^2 + x + 1 \label{eq:subeq_2-1} \\
%         y & = x^2
%     \end{align}
% \end{subequations}

% \subsection{Форматирование чисел и размерностей величин}\label{sec:units}

% Числа форматируются при помощи команды \verb|\num|:
% \num{5,3};
% \num{2,3e8};
% \num{12345,67890};
% \num{2,6 d4};
% \num{1+-2i};
% \num{.3e45};
% \num[exponent-base=2]{5 e64};
% \num[exponent-base=2,exponent-to-prefix]{5 e64};
% \num{1.654 x 2.34 x 3.430}
% \num{1 2 x 3 / 4}.
% Для написания последовательности чисел можно использовать команды \verb|\numlist| и \verb|\numrange|:
% \numlist{10;30;50;70}; \numrange{10}{30}.
% Значения углов можно форматировать при помощи команды \verb|\ang|:
% \ang{2.67};
% \ang{30,3};
% \ang{-1;;};
% \ang{;-2;};
% \ang{;;-3};
% \ang{300;10;1}.

% Обратите внимание, что ГОСТ запрещает использование знака <<->> для обозначения отрицательных чисел
% за исключением формул, таблиц и~рисунков.
% Вместо него следует использовать слово <<минус>>.

% Размерности можно записывать при помощи команд \verb|\si| и \verb|\SI|:
% \si{\farad\squared\lumen\candela};
% \si{\joule\per\mole\per\kelvin};
% \si[per-mode = symbol-or-fraction]{\joule\per\mole\per\kelvin};
% \si{\metre\per\second\squared};
% \SI{0.10(5)}{\neper};
% \SI{1.2-3i e5}{\joule\per\mole\per\kelvin};
% \SIlist{1;2;3;4}{\tesla};
% \SIrange{50}{100}{\volt}.
% Список единиц измерений приведён в таблицах~\cref{tab:unit:base,
%     tab:unit:derived,tab:unit:accepted,tab:unit:physical,tab:unit:other}.
% Приставки единиц приведены в~таблице~\cref{tab:unit:prefix}.

% С дополнительными опциями форматирования можно ознакомиться в~описании пакета \texttt{siunitx};
% изменить или добавить единицы измерений можно в~файле \texttt{siunitx.cfg}.

% \begin{table}
%     \centering
%     \captionsetup{justification=centering} % выравнивание подписи по-центру
%     \caption{Основные величины СИ}\label{tab:unit:base}
%     \begin{tabular}{llc}
%         \toprule
%         Название  & Команда                 & Символ         \\
%         \midrule
%         Ампер     & \verb|\ampere| & \si{\ampere}   \\
%         Кандела   & \verb|\candela| & \si{\candela}  \\
%         Кельвин   & \verb|\kelvin| & \si{\kelvin}   \\
%         Килограмм & \verb|\kilogram| & \si{\kilogram} \\
%         Метр      & \verb|\metre| & \si{\metre}    \\
%         Моль      & \verb|\mole| & \si{\mole}     \\
%         Секунда   & \verb|\second| & \si{\second}   \\
%         \bottomrule
%     \end{tabular}
% \end{table}

% \begin{table}
%     \small
%     \centering
%     \begin{threeparttable}% выравнивание подписи по границам таблицы
%         \caption{Производные единицы СИ}\label{tab:unit:derived}
%         \begin{tabular}{llc|llc}
%             \toprule
%             Название       & Команда                 & Символ              & Название & Команда & Символ \\
%             \midrule
%             Беккерель      & \verb|\becquerel| & \si{\becquerel}     &
%             Ньютон         & \verb|\newton| & \si{\newton}                                      \\
%             Градус Цельсия & \verb|\degreeCelsius| & \si{\degreeCelsius} &
%             Ом             & \verb|\ohm| & \si{\ohm}                                         \\
%             Кулон          & \verb|\coulomb| & \si{\coulomb}       &
%             Паскаль        & \verb|\pascal| & \si{\pascal}                                      \\
%             Фарад          & \verb|\farad| & \si{\farad}         &
%             Радиан         & \verb|\radian| & \si{\radian}                                      \\
%             Грей           & \verb|\gray| & \si{\gray}          &
%             Сименс         & \verb|\siemens| & \si{\siemens}                                     \\
%             Герц           & \verb|\hertz| & \si{\hertz}         &
%             Зиверт         & \verb|\sievert| & \si{\sievert}                                     \\
%             Генри          & \verb|\henry| & \si{\henry}         &
%             Стерадиан      & \verb|\steradian| & \si{\steradian}                                   \\
%             Джоуль         & \verb|\joule| & \si{\joule}         &
%             Тесла          & \verb|\tesla| & \si{\tesla}                                       \\
%             Катал          & \verb|\katal| & \si{\katal}         &
%             Вольт          & \verb|\volt| & \si{\volt}                                        \\
%             Люмен          & \verb|\lumen| & \si{\lumen}         &
%             Ватт           & \verb|\watt| & \si{\watt}                                        \\
%             Люкс           & \verb|\lux| & \si{\lux}           &
%             Вебер          & \verb|\weber| & \si{\weber}                                       \\
%             \bottomrule
%         \end{tabular}
%     \end{threeparttable}
% \end{table}

% \begin{table}
%     \centering
%     \begin{threeparttable}% выравнивание подписи по границам таблицы
%         \caption{Внесистемные единицы}\label{tab:unit:accepted}

%         \begin{tabular}{llc}
%             \toprule
%             Название        & Команда                 & Символ          \\
%             \midrule
%             День            & \verb|\day| & \si{\day}       \\
%             Градус          & \verb|\degree| & \si{\degree}    \\
%             Гектар          & \verb|\hectare| & \si{\hectare}   \\
%             Час             & \verb|\hour| & \si{\hour}      \\
%             Литр            & \verb|\litre| & \si{\litre}     \\
%             Угловая минута  & \verb|\arcminute| & \si{\arcminute} \\
%             Угловая секунда & \verb|\arcsecond| & \si{\arcsecond} \\ %
%             Минута          & \verb|\minute| & \si{\minute}    \\
%             Тонна           & \verb|\tonne| & \si{\tonne}     \\
%             \bottomrule
%         \end{tabular}
%     \end{threeparttable}
% \end{table}

% \begin{table}
%     \centering
%     \captionsetup{justification=centering}
%     \caption{Внесистемные единицы, получаемые из эксперимента}\label{tab:unit:physical}
%     \begin{tabular}{llc}
%         \toprule
%         Название                & Команда                 & Символ                 \\
%         \midrule
%         Астрономическая единица & \verb|\astronomicalunit| & \si{\astronomicalunit} \\
%         Атомная единица массы   & \verb|\atomicmassunit| & \si{\atomicmassunit}   \\
%         Боровский радиус        & \verb|\bohr| & \si{\bohr}             \\
%         Скорость света          & \verb|\clight| & \si{\clight}           \\
%         Дальтон                 & \verb|\dalton| & \si{\dalton}           \\
%         Масса электрона         & \verb|\electronmass| & \si{\electronmass}     \\
%         Электрон Вольт          & \verb|\electronvolt| & \si{\electronvolt}     \\
%         Элементарный заряд      & \verb|\elementarycharge| & \si{\elementarycharge} \\
%         Энергия Хартри          & \verb|\hartree| & \si{\hartree}          \\
%         Постоянная Планка       & \verb|\planckbar| & \si{\planckbar}        \\
%         \bottomrule
%     \end{tabular}
% \end{table}

% \begin{table}
%     \centering
%     \begin{threeparttable}% выравнивание подписи по границам таблицы
%         \caption{Другие внесистемные единицы}\label{tab:unit:other}
%         \begin{tabular}{llc}
%             \toprule
%             Название                  & Команда                 & Символ             \\
%             \midrule
%             Ангстрем                  & \verb|\angstrom| & \si{\angstrom}     \\
%             Бар                       & \verb|\bar| & \si{\bar}          \\
%             Барн                      & \verb|\barn| & \si{\barn}         \\
%             Бел                       & \verb|\bel| & \si{\bel}          \\
%             Децибел                   & \verb|\decibel| & \si{\decibel}      \\
%             Узел                      & \verb|\knot| & \si{\knot}         \\
%             Миллиметр ртутного столба & \verb|\mmHg| & \si{\mmHg}         \\
%             Морская миля              & \verb|\nauticalmile| & \si{\nauticalmile} \\
%             Непер                     & \verb|\neper| & \si{\neper}        \\
%             \bottomrule
%         \end{tabular}
%     \end{threeparttable}
% \end{table}

% \begin{table}
%     \small
%     \centering
%     \begin{threeparttable}% выравнивание подписи по границам таблицы
%         \caption{Приставки СИ}\label{tab:unit:prefix}
%         \begin{tabular}{llcc|llcc}
%             \toprule
%             Приставка & Команда                  & Символ      & Степень &
%             Приставка & Команда                  & Символ      & Степень   \\
%             \midrule
%             Иокто     & \verb|\yocto|  & \si{\yocto} & -24     &
%             Дека      & \verb|\deca|  & \si{\deca}  & 1         \\
%             Зепто     & \verb|\zepto|  & \si{\zepto} & -21     &
%             Гекто     & \verb|\hecto|  & \si{\hecto} & 2         \\
%             Атто      & \verb|\atto|  & \si{\atto}  & -18     &
%             Кило      & \verb|\kilo|  & \si{\kilo}  & 3         \\
%             Фемто     & \verb|\femto|  & \si{\femto} & -15     &
%             Мега      & \verb|\mega|  & \si{\mega}  & 6         \\
%             Пико      & \verb|\pico|  & \si{\pico}  & -12     &
%             Гига      & \verb|\giga|  & \si{\giga}  & 9         \\
%             Нано      & \verb|\nano|  & \si{\nano}  & -9      &
%             Терра     & \verb|\tera|  & \si{\tera}  & 12        \\
%             Микро     & \verb|\micro|  & \si{\micro} & -6      &
%             Пета      & \verb|\peta|  & \si{\peta}  & 15        \\
%             Милли     & \verb|\milli|  & \si{\milli} & -3      &
%             Екса      & \verb|\exa|  & \si{\exa}   & 18        \\
%             Санти     & \verb|\centi|  & \si{\centi} & -2      &
%             Зетта     & \verb|\zetta|  & \si{\zetta} & 21        \\
%             Деци      & \verb|\deci| & \si{\deci}  & -1      &
%             Иотта     & \verb|\yotta| & \si{\yotta} & 24        \\
%             \bottomrule
%         \end{tabular}
%     \end{threeparttable}
% \end{table}

% \subsection{Заголовки с формулами: \texorpdfstring{\(a^2 + b^2 = c^2\)}{%
%         a\texttwosuperior\ + b\texttwosuperior\ = c\texttwosuperior},
%     \texorpdfstring{\(\left\vert\textrm{{Im}}\Sigma\left(
%             \protect\varepsilon\right)\right\vert\approx const\)}{|ImΣ (ε)| ≈ const},
%     \texorpdfstring{\(\sigma_{xx}^{(1)}\)}{σ\_\{xx\}\textasciicircum\{(1)\}}
% }\label{subsec:with_math}

% Пакет \texttt{hyperref} берёт текст для закладок в pdf-файле из~аргументов
% команд типа \verb|\section|, которые могут содержать математические формулы,
% а~также изменения цвета текста или шрифта, которые не отображаются в~закладках.
% Чтобы использование формул в заголовках не вызывало в~логе компиляции появление
% предупреждений типа <<\texttt{Token not allowed in~a~PDF string
%     (Unicode):(hyperref) removing...}>>, следует использовать конструкцию
% \verb|\texorpdfstring{}{}|, где в~первых фигурных скобках указывается
% формула, а~во~вторых "--- запись формулы для закладок.

% \section{Рецензирование текста}\label{sec:markup}

% В шаблоне для диссертации и автореферата заданы команды рецензирования.
% Они видны при компиляции шаблона в режиме черновика или при установке
% соответствующей настройки (\verb+showmarkup+) в~файле \verb+common/setup.tex+.

% Команда \verb+\todo+ отмечает текст красным цветом.
% \todo{Например, так.}

% Команда \verb+\note+ позволяет выбрать цвет текста.
% \note{Чёрный, } \note[red]{красный, } \note[green]{зелёный, }
% \note[blue]{синий.} \note[orange]{Обратите внимание на ширину и расстановку
%     формирующихся пробелов, в~результате приведённой записи (зависит также
%     от~применяемого компилятора).}

% Окружение \verb+commentbox+ также позволяет выбрать цвет.

% \begin{commentbox}[red]
%     Красный текст.

%     Несколько параграфов красного текста.
% \end{commentbox}

% \begin{commentbox}[blue]
%     Синяя формула.

%     \begin{equation}
%         \alpha + \beta = \gamma
%     \end{equation}
% \end{commentbox}

% \verb+commentbox+ позволяет закомментировать участок кода в~режиме чистовика.
% Чтобы убрать кусок кода для всех режимов, можно использовать окружение
% \verb+comment+.

% \begin{comment}
% Этот текст всегда скрыт.
% \end{comment}

% \section{Работа со списком сокращений и~условных обозначений}\label{sec:acronyms}

% С помощью пакета \texttt{nomencl} можно создавать удобный сортированный список
% сокращений и условных обозначений во время написания текста. Вызов
% \verb+\nomenclature+ добавляет нужный символ или сокращение с~описанием
% в~список, который затем печатается вызовом \verb+\printnomenclature+
% в~соответствующем разделе.
% Для того, чтобы эти операции прошли, потребуется дополнительный вызов
% \verb+makeindex -s nomencl.ist -o %.nls %.nlo+ в~командной строке, где вместо
% \verb+%+ следует подставить имя главного файла проекта (\verb+dissertation+
% для этого шаблона).
% Затем потребуется один или два дополнительных вызова компилятора проекта.
% \begin{equation}
%     \omega = c k,
% \end{equation}
% где \( \omega \) "--- частота света, \( c \) "--- скорость света, \( k \) "---
% модуль волнового вектора.
% \nomenclature{\(\omega\)}{частота света\nomrefeq}
% \nomenclature{\(c\)}{скорость света\nomrefpage}
% \nomenclature{\(k\)}{модуль волнового вектора\nomrefeqpage}
% Использование
% \begin{verbatim}
% \nomenclature{\(\omega\)}{частота света\nomrefeq}
% \nomenclature{\(c\)}{скорость света\nomrefpage}
% \nomenclature{\(k\)}{модуль волнового вектора\nomrefeqpage}
% \end{verbatim}
% после уравнения добавит в список условных обозначений три записи.
% Ссылки \verb+\nomrefeq+ на последнее уравнение, \verb+\nomrefpage+ "--- на
% страницу, \verb+\nomrefeqpage+ "--- сразу на~последнее уравнение и~на~страницу,
% можно опускать и~не~использовать.

% Группировкой и сортировкой пунктов в списке можно управлять с~помощью указания
% дополнительных аргументов к команде \verb+nomenclature+.
% Например, при вызове
% \begin{verbatim}
% \nomenclature[03]{\( \hbar \)}{постоянная Планка}
% \nomenclature[01]{\( G \)}{гравитационная постоянная}
% \end{verbatim}
% \( G \) будет стоять в списке выше, чем \( \hbar \).
% Для корректных вертикальных отступов между строками в описании лучше
% не~использовать многострочные формулы в~списке обозначений.

% \nomenclature{%
%     \( \begin{rcases}
%         a_n \\
%         b_n
%     \end{rcases} \)%
% }{коэффициенты разложения Ми в дальнем поле соответствующие электрическим и
%     магнитным мультиполям}
% \nomenclature[a\( e \)]{\( {\boldsymbol{\hat{\mathrm e}}} \)}{единичный вектор}
% \nomenclature{\( E_0 \)}{амплитуда падающего поля}
% \nomenclature{\( j \)}{тип функции Бесселя}
% \nomenclature{\( k \)}{волновой вектор падающей волны}
% \nomenclature{%
%     \( \begin{rcases}
%         a_n \\
%         b_n
%     \end{rcases} \)%
% }{и снова коэффициенты разложения Ми в дальнем поле соответствующие
%     электрическим и магнитным мультиполям. Добавлено много текста, так что
%     описание группы условных обозначений значительно превысило высоту этой
%     группы...}
% \nomenclature{\( L \)}{общее число слоёв}
% \nomenclature{\( l \)}{номер слоя внутри стратифицированной сферы}
% \nomenclature{\( \lambda \)}{длина волны электромагнитного излучения в вакууме}
% \nomenclature{\( n \)}{порядок мультиполя}
% \nomenclature{%
%     \( \begin{rcases}
%         {\mathbf{N}}_{e1n}^{(j)} & {\mathbf{N}}_{o1n}^{(j)} \\
%         {\mathbf{M}_{o1n}^{(j)}} & {\mathbf{M}_{e1n}^{(j)}}
%     \end{rcases} \)%
% }{сферические векторные гармоники}
% \nomenclature{\( \mu \)}{магнитная проницаемость в вакууме}
% \nomenclature{\( r, \theta, \phi \)}{полярные координаты}
% \nomenclature{\( \omega \)}{частота падающей волны}

% С помощью \verb+nomenclature+ можно включать в~список сокращения,
% не~используя их~в~тексте.
% % запись сокращения в список происходит командой \nomenclature,
% % а не употреблением самого сокращения
% \nomenclature{FEM}{finite element method, метод конечных элементов}
% \nomenclature{FIT}{finite integration technique, метод конечных интегралов}
% \nomenclature{FMM}{fast multipole method, быстрый метод многополюсника}
% \nomenclature{FVTD}{finite volume time-domain, метод конечных объёмов
%     во~временной области}
% \nomenclature{MLFMA}{multilevel fast multipole algorithm, многоуровневый
%     быстрый алгоритм многополюсника}
% \nomenclature{BEM}{boundary element method, метод граничных элементов}
% \nomenclature{CST MWS}{Computer Simulation Technology Microwave Studio
%     программа для компьютерного моделирования уравнен Максвелла}
% \nomenclature{DDA}{discrete dipole approximation, приближение дискретиных
%     диполей}
% \nomenclature{FDFD}{finite difference frequency domain, метод конечных
%     разностей в~частотной области}
% \nomenclature{FDTD}{finite difference time domain, метод конечных разностей
%     во~временной области}
% \nomenclature{MoM}{method of moments, метод моментов}
% \nomenclature{MSTM}{multiple sphere T-Matrix, метод Т-матриц для множества
%     сфер}
% \nomenclature{PSTD}{pseudospectral time domain method, псевдоспектральный метод
%     во~временной области}
% \nomenclature{TLM}{transmission line matrix method, метод матриц линий передач}

% \FloatBarrier
