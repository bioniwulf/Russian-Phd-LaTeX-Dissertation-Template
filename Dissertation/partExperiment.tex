% \chapter{Исседование эффективности адаптивного управления ДРК}\label{ch:Experiment}
% \section{Модель динамики ПА}\label{sec:Experiment/Model}

% \begin{notequestion}
% Тут подробно описана динамика АНПА для качественной симуляции движения. До этого вопрос о АНПА как объекте управления не поднимался вообще.
% \end{notequestion}

% Традиционно, запись динамической модели пространственного движения подводного аппарата описывается в виде шести нелинейных дифференциальных управлений.
% Эти уравнения полностью учитывают взаимовлияния между всеми степенями свободы ПА, а так же гидродинамические и гидростатические силы и моменты, действующие на них со стороны окружающей вязкой среды.

% Пусть задана связанная с ПА система координат $Oxyz$ (ССК).
% ССК выбирается таки образом что бы распределение масс и тензор инерции такой системы был симметричен.
% Ось $Ox$ направлена вдоль продольной оси аппарата, ось $Oy$ направлена вдоль поперечной оси аппарата в направлении от левого борта к правому, ось $Oz$ достраивает СК до правосторонней.

% В качестве вектора управления $\nu$ удобно использовать обобщенный вектор сил и моментов, действующих на объект управления в связанной с ним системе координат (ССК), при $n=6$. Здесь и далее он будет определен как $\vect{\tau} = [f_x,f_y,f_z,m_x,m_y,m_z]^T$ где $f_x,f_y,f_z$ – проекции сил затребованных системой управления движением на продольную (ось $Ox$) поперечную (ось $Oy$) и нормальную оси (ось $Oz$) связанной с аппаратом системе координат, а $m_x,m_y,m_z$ – соответствующие затребованные проекции моментов. 

% Тогда модель динамики подводного аппарата записанная в векторно-матричном виде имеет следующий вид \cite{Filaretov}:
% \begin{equation}
%     \label{eq:dynamic_force}
%     \vect{M}\dot{\vect{\nu}} + \vect{C}(\vect{\nu})\vect{\nu} + \vect{D}(\vect{\nu})\vect{\nu} + g(\vect{\eta})=\vect{\tau}
% \end{equation}

% \noindent где 
% \begin{itemize}
%     \item $\vect{M} \in \mathspace{R}^{6\times6}$ -- тензор инерции ПА, которая включает присоединенные массы и моменты инерции жидкости;
%     \item $\vect{C} \in \mathspace{R}^{6\times6}$ -- матрица кориолисовых и центробежных сил;
%     \item $\vect{D} \in \mathspace{R}^{6\times6}$ -- матрица гидродинамических сил и моментов;
%     \item $g(\vect{\eta}) \in \mathspace{R}^{6}$ -- вектор гидростатических сил и моментов.
% \end{itemize}

% Вектор состояния системы описывается переменными $\vect{\nu}$ и $\vect{\eta}$.
% Эти переменные определяются следующим образом:
% \begin{itemize}
%     \item $\vect{\eta} = [\vect{n}_1^T, \vect{n}_2^T] = [x,y,z, \phi, \theta, \psi]^T$ -- вектор положения и ориентации ПА в инерциальной системе координат (ИСК), где $\vect{\eta}_1 = [x,y,z]^T$ определяет положение подводного аппарата. Вектор $\vect{\eta}_2 = [\phi, \theta, \psi]^T$ определяет его ориентацию где $\phi, \theta, \psi$ -- это углы Эйлера, которые в терминологии подводной робототехники называются, соответственно, угол крена, дифферента и курса ПА.
%     \item $\vect{\nu} = [\vect{\nu}_1^T, \vect{\nu}_2^T] = (u,v,w,p,q,r)$, где $\vect{\nu}_1$ и $\vect{\nu}_2^T$, соответственно, определяют линейную и угловую скорость движения ПА в ССК.
% \end{itemize}

% \paragraph{Матрица инерции}
% Распределение массы ПА определяется тензором инерции.
% В уравнении \ref{eq:dynamic_force} тензор инерции $\vect{M}$ представлен в виде совокупного действия инерции твердого тела $\vect{M}_{RB}$ (формула \ref{eq:matrix_rb}) и тензора присоединённых масс жидкости $\vect{M}_{A}$ (формула \ref{eq:matrix_added}).
% В виду того что тензор инерции является симметричным и положительно определённым всегда возможно найти такую СК в которой матрица тензор инереции приобретает диагональный вид при определенных допущениях о симметричности ПА.
% Такая СК называется базисной (principle frame) \cite{vervoort2009modeling}.

% Тогда запись $\vect{M}$ будет следующей:

% \begin{equation*}
%     \vect{M} = \vect{M}_{RB} + \vect{M}_{A}
% \end{equation*}

% Матрица $\vect{M}_{A}$ определяет дополнительную инерцию ПА связанную с захватом жидкости окружающей подводный аппарат которую он ``захватывает'' при движении.
% Значение элементов этой матрицы зависят от формы подводного аппарата.
% Причем недиагональные элементы при движении на относительно низкой скорости, в основном, отбрасываются на основании симметричности ПА относительно основных осей ССК \cite{antonelli2014underwater}.
% Это позволяет упростить $\vect{M}_{A}$ до диагональной матрицы.

% \begin{equation}
% \label{eq:matrix_rb}    
%     M_{RB} =
%     \begin{bmatrix}
%         m & 0 & 0 & 0 & m \cdot z_G  & -m \cdot y_G \\
%         0 & m & 0 & -m \cdot z_G & 0 & m \cdot x_G \\
%         0 & 0 & m & m \cdot y_G & -m \cdot x_G & 0 \\
%         0 & -m \cdot z_G & m \cdot y_G & J_{xx} & -J_{xy} & -J_{xz} \\
%         m \cdot z_G & 0 & -m \cdot x_G & -J_{yx} & J_{yy} & -J_{yz} \\
%         -m \cdot y_G & m \cdot x_G & 0 & -J_{zx} & -J_{zy} & J_{zz}
%     \end{bmatrix}
% \end{equation}

% \noindent где $m$ определяет массу аппарата; $[x_G, y_G, z_G]^T$ -- координаты ЦМ подводного аппарата в ССК; $J_{xx}, J_{yy}, J_{zz}, J_{xy}, J_{yz}, J_{zx}$ -- моменты инерции относительно главных и вспомогательных осей инерции.

% \begin{equation}
% \label{eq:matrix_added}
%     M_{A} =
%     \begin{bmatrix}
%         X_{\dot{u}} & 0 & 0 & 0 & 0 & 0 \\
%         0 & Y_{\dot{v}} & 0 & 0 & 0 & 0 \\
%         0 & 0 & Z_{\dot{w}} & 0 & 0 & 0 \\
%         0 & 0 & 0 & K_{\dot{p}} & 0 & 0 \\
%         0 & 0 & 0 & 0 & M_{\dot{q}} & 0 \\
%         0 & 0 & 0 & 0 & 0 & N_{\dot{r}} \\
%     \end{bmatrix}
% \end{equation}

% \paragraph{Матрица кориолисовых и центробежных сил}
% Матрица $\vect{C}(\vect{\nu})$ таким же образом как и тензор инерции $\vect{M}$ состоит из двух элементов (уравнение \ref{eq:coriolis_common}) -- матрицы $\vect{C}_{RB}(\vect{\nu})$ (уравнение), которая определяет центробежные и кориолисовы силы действующие на ПА и матрицы $\vect{C}_{A}(\vect{\nu})$, которая определяет центробежные и кориолисовы силы действующие на присоединённую жидкость.
% В обеих матрицах элементы стоящие на главной диагонали (элементы $a_{ij}$ при $i=j$) определяют действие кориолисовых сил, а остальные элементы матрицы - центробежных.
% Матрица $\vect{C}(\vect{\nu})$ всегда может быть представлена в виде кососимметричной матрицы при движении ПА в идеальной жидкости.

% \begin{equation}
%     \label{eq:coriolis_common}
%     \vect{C}(\vect{\nu}) = \vect{C}_{RB}(\vect{\nu}) + \vect{C}_A(\vect{\nu})
% \end{equation}

% \begin{equation}
%     \label{eq:coriolis_rb}
%     \vect{C}_{RB}(\vect{\nu}) =
%     \begin{bmatrix}
%         0 & \vect{C}_{RB}^{11}(\vect{\nu}) \\
%         \vect{C}_{RB}^{21}(\vect{\nu}) & \vect{C}_{RB}^{22}(\vect{\nu}) \\
%     \end{bmatrix}
% \end{equation}

% \noindent где:
% \begin{equation*}
%     \vect{C}_{RB}^{11}(\vect{\nu}) =
%     \begin{bmatrix}
%         m(q\cdot y_G + r \cdot z_G) & -m(q \cdot x_g - w) & -m(r \cdot x_G + v) \\
%         -m(p \cdot y_G + w) & m(p \cdot x_G + r \cdot z_G) & -m(r \cdot y_G - u) \\
%         -m(p \cdot z_G - v) & -m(q \cdot z_G + u) & m(p \cdot x_G + q \cdot y_G)
%     \end{bmatrix}
% \end{equation*}

% \begin{equation*}
%     \vect{C}_{RB}^{21}(\vect{\nu}) =
%     \begin{bmatrix}
%     -m(q \cdot y_G + r \cdot z_G) & m(p \cdot y_G + w) & m(p \cdot z_G - v) \\
%     m (q \cdot x_G - w) & -m(p \cdot x_G + r \cdot z_G) & m(q \cdot z_G + u) \\
%     m(r \cdot x_G + v) & m(r \cdot y_G - u) & -m(p \cdot x_G + q \cdot y_G)
%     \end{bmatrix}
% \end{equation*}

% \begin{equation*}
%     \vect{C}_{RB}^{22}(\vect{\nu}) =
%     \begin{bmatrix}
%     0 & -q J_{yz} - p J_{xz} + r J_{zz} & r J_{yz} + p J_{xy} - q J_{yy} \\
%     q J_{yz} + p J_{xz} - r J_{zz} & 0 & -r J_{xy} - q J_{xy} + p J_{xx} \\
%     -r J_{yz} - p J_{xy} + q J_{yy} & r J_{xz} + q J_{xy} - p J_{xx} & 0
%     \end{bmatrix}
% \end{equation*}

% \begin{equation}
%     \label{eq:coriolis_added}
%     \vect{C}_{A}(\vect{\nu}) =
%     \begin{bmatrix}
%         0 & 0 & 0 & 0 & -Z_{\dot{w}} \cdot w & Y_{\dot{v}} \cdot v \\
%         0 & 0 & 0 & Z_{\dot{w}} \cdot w & 0 & -X_{\dot{u}} \cdot u \\
%         0 & 0 & 0 & -Y_{\dot{v}} \cdot v & 0 & X_{\dot{u}} \cdot u \\
%         0 & -Z_{\dot{w}} \cdot w & Y_{\dot{v}} \cdot v & 0 & -N_{\dot{r}} \cdot r & M_{\dot{q}} \cdot q \\
%         Z_{\dot{w}} \cdot w & 0 & -X_{\dot{u}} \cdot u & N_{\dot{r}} \cdot r & 0 & -K_{\dot{p}} \cdot p \\
%         -Y_{\dot{v}} \cdot v & X_{\dot{u}} \cdot u & 0 & -M_{\dot{q}} \cdot q & K_{\dot{p}} \cdot p & 0
%     \end{bmatrix}
% \end{equation}

% \paragraph{Тензор сил сопротивления}
% При движении ПА под водой, он испытывает на себе диссипативную силу связанную с высокой вязкостью жидкости.
% При относительно низкой скорости движения подводного аппарата, можно сделать предположение что действие этих сил независимо по осям ССК.
% Тогда тензор сил сопротивления среды можно представить в виде диагональной матрицы.
% Таким образом, члены гидродинамического демпфирования могут быть аппроксимированы несвязанной диагональной матрицей, составленной из коэффициентов сил сопротивления среды \cite{fossen1999guidance}.
% Эти коэффициенты могут быть рассчитаны при помощи CFD (Computational Fluid Dynamics) программ для линейных степеней свобод.
% Коэффициенты при вращательных степенях свободы могуть быть получены аналитически \cite{georgiades2005simulation}.

% Если учитывать только квадратичные коэффициенты сопротивления среде, то тензор сил сопротивления $\vect{D}(\vect{\nu})\vect{\nu}$ будет выглядеть следующим образом:
% \begin{equation*}
%     \vect{D}(\vect{\nu}) = -
%     \begin{bmatrix}
%         X_{u|u|}|u| & 0 & 0 & 0 & 0 & 0 \\
%         0 & Y_{v|v|}|v| & 0 & 0 & 0 & 0 \\
%         0 & 0 & Z_{w|w|}|w| & 0 & 0 & 0 \\
%         0 & 0 & 0 & K_{p|p|}|p| & 0 & 0 \\
%         0 & 0 & 0 & 0 & M_{q|q|}|q| & 0 \\
%         0 & 0 & 0 & 0 & 0 & N_{r|r|}|r| \\
%     \end{bmatrix}
% \end{equation*}

% \paragraph{Гидростатическая сила}
% Пусть на аппарат действует сила тяжести $\vect{f}_g^b$ и она приложена к точке $\vect{r}_g^b:=[x_g,y_g,z_g]^T$
% Эта точка представляет собой координату ЦМ аппарата в ССК.
% Кроме этого, на погруженный в воду аппарат действует сила Архимеда $\vect{f}_g^b$, которая приложена к ЦВ с координатами $\vect{r}_b^b:=[x_b,y_b,z_b]^T$.

% Если $m$ -- это масса ПА, $g$ -- ускорение свободного падения, $\nabla$ -- вытесняемый объем жидкости, а $\rho$ -- плотность жидкости, то сила тяжести и сила Архимеда будут представлены в следующей записи:
% \begin{equation*}
%     W=mg, \: B=\rho g \nabla
% \end{equation*}

% В инерциальной системе координат в нотации NED эти силы будут записаны в векторном виде следующим образом:
% \begin{equation*}
%     \label{eq:hydrostatic_n}
%     \vect{f}_g^n = 
%     \begin{bmatrix}
%     0 \\
%     0 \\
%     W
%     \end{bmatrix}
%     ,
%     \vect{f}_g^n = - 
%     \begin{bmatrix}
%     0 \\
%     0 \\
%     B
%     \end{bmatrix}
% \end{equation*}

% в виду того, что уравнение динамики ПА представлено в ССК, необходимо преобразовать уравнение \ref{eq:hydrostatic_n} в ССК.
% Удобнее всего для этого использовать матрицу Эйлерова преобразования $\vect{R}^n_b(\vect{\Theta_{nb}})$, тогда гидростатическая сила $\vect{g}(\vect{\eta})$ в ССК будет записана следующим образом:

% \begin{equation*}
%     \vect{g}(\vect{\eta}) = -
%     \begin{bmatrix}
%         \vect{R}^n_b(\vect{\Theta_{nb}})^{-1}(\vect{f}_g^n + \vect{f}_b^n) \\
%         \vect{r}_g^b \times \vect{R}^n_b(\vect{\Theta_{nb}})^{-1} \vect{f}_g^n + \vect{r}_b^b \times \vect{R}^n_b(\vect{\Theta_{nb}})^{-1} \vect{f}_b^n
%     \end{bmatrix}
% \end{equation*}

% Если раскрыть векторную запись, то гидростатическая сила будет представлена следующим выражением:

% \begin{equation*}
%     \vect{g}(\vect{\eta}) =
%     \begin{bmatrix}
%         (W - B)\sin{\theta} \\
%         -(W - B)\cos{\theta} \sin{\phi} \\
%         -(W - B)\cos{\theta} \cos{\phi} \\
%         -(y_gW - y_bB)\cos{\theta} \cos{\phi} + (z_gW - z_bB)\cos{\theta} \sin{\phi} \\
%         (z_gW - z_bB)\sin(\theta) + (x_gW - x_bB)\cos{\theta} \cos{\phi} \\
%         -(x_gW - x_bB)\cos{\theta} \sin{\phi} - (y_gW - y_bB) \sin{\theta}
%     \end{bmatrix}
% \end{equation*}

% \section{Реализация модели динамики АНПА}\label{sec:Experiment/ModelImplement}
% \begin{noteplan}
% Тут я всю эту динамику максимально упрощу и линеаризую для АНПА и покажу структурную схему численной симуляции
% \end{noteplan}

% \section{Сравнение различных методов управления ДРК на примере переходного процесса по глубине}\label{sec:Experiment/Test}

% \begin{noteplan}
% Тут будет сравнение методов распределения по энергетике на какой нибудь траектории. Будем только два метода сравнивать. Который в ИПМТ и предлагаемый.
% \end{noteplan}

% \section{Выводы по главе 5}
