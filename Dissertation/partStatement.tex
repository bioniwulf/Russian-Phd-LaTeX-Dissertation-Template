\chapter{Обзор современных подходов к решению задачи управления ДРК ПА} \label{ch:Statement}
\section{Формулировка задачи управления ДРК ПА}\label{sec:Statement/ProblemStatement}
Пусть динамика подводного аппарата, оснащенного избыточным ДРК, определена в формулировках метода пространства состояний следующим образом:
\begin{equation*}
    \vect{\dot{x}}(t) = a(\vect{x}(t)) + B_u(\vect{x}(t))\vect{u}(t)
\end{equation*}
\noindent где
\begin{itemize}
    \item $\vect{x}(t) \in \mathspace{R}^n$ -- вектор состояния системы;
    \item $\vect{u}(t) \in \mathspace{U} \subset{\mathspace{R}}^k$ -- вектор управления исполнительными механизмами (control input), где подмножество $\mathspace{U}$ можно интерпретировать как ограничение величины команд управления, вызванное насыщением статической характеристики движителей, механическими ограничениями угла поворота рулей или иными особенностями ИМ;
    \item $a(\vect{x}(t)): \mathspace{R}^n \rightarrow \mathspace{R}^n$ -- гладкая нелинейная функция, описывающая управляемую систему;
    \item $B_u(\vect{x}(t)) \in \mathspace{R}^{n \times k}$ -- матрица, определяющая влияние вектора управления на состояние системы.
\end{itemize}
Пусть ранг матрицы $B_u$ равен $m$ и он меньше чем $k$ вследствие избыточности ДРК.
Такая матрица является недоопределённой, а соответствующая ей система либо имеет бесконечное число линейно зависимых решений по параметру $u$, либо не имеет решений вовсе.

Матрица $B_u$ может быть разложена следующим образом:
\begin{equation}
    \label{eq:dynamic_statespace}
    B_u(\vect{x})(t) = B_{\nu}(\vect{x}) B(\vect{x})
\end{equation}
\noindent где обе матрицы $B_{\nu}(\vect{x})$ и $B(\vect{x})$ обладают рангом $m$.
Это ведёт к новому описанию динамической системы \ref{eq:dynamic_statespace}, которое может быть представлено следующим образом:

\begin{equation}
    \label{eq:dynamic_statespace_new}
    \begin{array}{l}
        \vect{\dot{x}}(t) = a(\vect{x}(t)) + B_{\vec{\nu}}(\vect{x}(t))\vect{\nu}(t) \\
        \vect{\nu}(t) = B(\vect{x}(t))\vect{u}(t)
    \end{array}
\end{equation}
\noindent где $\vect{\nu}(t) \in \mathspace{A} \subset \mathspace{R}^n$ можно интерпретировать как обобщенное действие всех исполнительных механизмов на объект управления или вектор виртуального управления (virtual input), а подмножество $\mathspace{A}$ получается аффинным преобразованием из подмножества $\mathspace{U}$ под действием матрицы $B(x)$.

Удобно раскладывать матрицу $B_u$ таким образом, чтобы матрица $B_{\nu}$ была квадратной ($n=m$). При этом матрица будет полноранговой, а решение уравнения для первой части системы \ref{eq:dynamic_statespace_new} единственным. В качестве вектора управления удобно использовать обобщенный вектор сил и моментов, действующих на объект управления в связанной с ним системе координат (ССК). При $n=6$ его можно определить как $\vect{\nu} = [f_x,f_y,f_z,m_x,m_y,m_z]^T$ где $f_x,f_y,f_z$ -- проекции сил затребованных системой управления движением на продольную поперечную и нормальную оси связанной с аппаратом системы координат, а $m_x,m_y,m_z$ -- соответствующие затребованные проекции моментов. 

Тем не менее матрица $B(\vect{x})$ в случае избыточного ДРК остается недоопределённой. Фактически это ведет к тому что для вектора $\nu_c$, который был затребован системой управления, может быть неопределённое множество решений уравнения \ref{eq:dynamic_statespace_new}.

Задача поиска оптимального вектора управления движением может быть поставлена в рамках обоих вариантов описания системы представленных выше.
Пусть задача оптимального управления поставлена в рамках квадратичной оптимизации, тогда для описания \ref{eq:dynamic_statespace} задача будет сформулирована следующим образом \cite{10.1016/j.automatica.2004.09.007}

\begin{gather*}
    \min \int_0^{\infty} \left[ q(x) + u^T R_u(x) u \right] dt \\
    \text{при условии } u \in \mathspace{U} \notag
\end{gather*}
\noindent где $q(\vect{x}) \geq 0, R_u(\vect{x}) = R_u^T(\vect{x}) \geq 0$ -- некоторые критерии оптимизации.

При этом описание \ref{eq:dynamic_statespace_new} естественным образом ведет к постановке двух независимых оптимизационных задач, которые могут быть записаны следующим образом:

\begin{gather}
    \min \int_0^{\infty} \left[ q(x) + \nu^T R_{\nu}(x) \nu \right] dt \\
    \min \left( ||Q_s|| + J(\vect{x}, \vect{u}, t) \right) \label{eq:Statement/AllocationProblem} \\
    \text{при условии } \vect{\nu}-B(\vect{x})\vect{u} = \vect{s}, u \in \mathspace{U} \notag
\end{gather}
\noindent где
\begin{itemize}
    \item $q(\vect{x}) \geq 0, R_{\nu}(\vect{x}) = R_{\nu}^T(\vect{x}) \geq 0$ -- некоторые коэффициенты оптимизации;
    \item $s$ -- невязку вектора виртуального управления, которая определяет меру различия между заданным и сформированным вектором управления;
    \item $Q_s$ -- матрица, формализующая приоритеты работы того или иного канала управления при выходе вектора $\nu$ за пределы допустимого множества $\mathspace{A}$.
    \item $J(\vect{x}, \vect{u}, t)$ -- некоторый функционал качества.
\end{itemize}

В работе \cite{10.1016/j.automatica.2004.09.007} показано, что оптимальность решения сохраняется при переходе от задачи оптимизации \ref{eq:dynamic_statespace} к двум независимым задачам \ref{eq:dynamic_statespace_new}. При этом второй подход позволяет достичь следующих преимуществ:
\begin{itemize}
    \item Решение задачи оптимального управления \ref{eq:dynamic_statespace} для нелинейных систем трудоемко и требует значительных численных расчётов, но при этом, в случае неизменного критерия оптимизации $R_{\nu}$ и изменяющихся критериев оптимизации $J(\vect{x}, \vect{u}, t)$ и $Q$, нет необходимости заново получать решение уравнения \ref{eq:dynamic_statespace}.
    \item В первом подходе изменение параметров оптимизации $R_{u}$ влияет как на изменение поведения системы в целом, так и на изменение распределения управляющих команд. Во втором случае задачи изолированы друг от друга и изменение $R_{\nu}$ влияет только на поведение системы, не затрагивая работу ДРК.
    \item Реализация системы управления движением может быть архитектурно разделена на два независимых уровня и в рамках каждого из них могут быть применены различные подходы к решению. При этом важно, что задача управления движением подводного аппарата может быть полностью абстрагирована от структуры его ДРК, обеспечив единый и универсальный подход к разработке контура управления движением для произвольного типа ПА.
    \item Ограничения, накладываемые на общую задачу оптимального управления \ref{eq:dynamic_statespace}, существенно усложняют её численное решение, особенно когда подмножество   является невыпуклым. При раздельном подходе можно решать задачу \ref{eq:dynamic_statespace_new}, условно считая задачу без ограничений, при этом накладывая ограничения только на более простую задачу, решение которой с учётом ограничений технически реализуемо современными вычислительными средствами в режиме реального времени.
    \item Реализация раздельных уровней управления движением позволяет существенно упростить систему аккомодации за счет её переноса в область ответственности задачи управления ДРК.
\end{itemize}

Отдельно стоит упомянуть случай при $k-n < 0$ для системы \ref{eq:dynamic_statespace}. Такой случай подразумевает, что исполнительных механизмов ДРК меньше чем размерность вектора состояния системы, такие системы можно назвать дефицитными (under-actuated system), а соответствующие ей матрица $B_u$ является переопределённой или плохо обусловленной. В этом случае задача управления ДРК тесно связана с системой управления движением ПА, и её сложно сформулировать обособленно. Отдельные примеры решения этой задачи для различных типов АНПА представлены в литературе \cite{10.1049/iet-cta.2009.0265, 10.1109/cdc.2002.1184546}.

\section{Методы решения задачи управления ДРК}\label{sec:Statement/Methods}
Существует достаточно много подходов к постановке и решению задачи управления ДРК.
В рамках данного обзора \cite{костенко2020методы} они разделены на две большие группы.
В первую группу отнесены те задачи, в которых вектор виртуального управления пропорционален вектору управления ИМ, то есть $\vect{\nu}(t) = B \vect{u}(t)$, и это допущение было сделано в формулировки задачи управления ДРК. Но в то же время существует отдельная группа систем, где это допущение не может быть принято.
\subsection{Линейные системы исполнительных механизмов ДРК}

В подавляющем большинстве случаев к этой группе относят практически все телеуправляемые необитаемые подводные аппараты (ТНПА) с фиксированными движителями, а также большая часть АНПА оснащенных фиксированными движителями и/или рулями управления \cite{костенко2017разработка, костенко2019задача}.
В статье \cite{yuh2000design} представлен обзор различных АНПА разработанных до 2000-го года за рубежом.
Большинство представленных аппаратов оснащено одним или двумя маршевыми движителями, которые работают совместно с рулями управления.
К этой группе также могут быть отнесены такие аппараты как «МТ-2010» \cite{борейко2011малогабаритный}, «ММТ-3000» \cite{горнак2007ммт} и другие аппараты разработанные в Институте проблем морских технологий ДВО РАН которые оснащены маршевой движительно-рулевой группой и подруливающими устройствами.

Для линейных систем исполнительных механизмов исторически первыми появились статические модели, описывающие их поведение, и соответствующие им статические методы оптимизации, но после 2000-го года начали появляться исследования, в рамках которых учитывалась динамическая модель исполнительных механизмов при решении задачи оптимального управления ДРК.

\subsubsection{Аналитическое решение при $\vect{u} \in \mathspace{R}^k$}
Отдельным случаем является аналитическое решение задачи при отсутствии ограничений на управляющие команды, т.е. $\vect{u} \in \mathspace{R}^k$.
Такая ситуация отчасти является синтетической, но может быть к ней сведена подбором специальных контуров управления с затяжными переходными процессами.
При отсутствии ограничений на команды управления, оптимизационная задача может быть решена на основе метрики $L_2$ (евклидова норма):
\begin{gather*}
    \min \frac{1}{2}(\vect{u} - \vect{u_p})W(\vect{u} - \vect{u_p}) \\
    \text{при } \vect{\nu}_c = B\vect{u} \notag
\end{gather*}
\noindent где $\vect{u_p}$ -- желаемое значение вектора управления ИМ в случае отсутствия управления, а $W$ -- диагональная матрица положительно определённых весовых коэффициентов.

Решение данной задачи может быть получено аналитическим образом и имеет следующий вид \cite{fossen1991adaptive}:
\begin{equation*}
    \vect{u} = (I-CB)\vect{u}_p + C \nu_c
\end{equation*}
\noindent где $I$ -- единичная матрица, а матрица $C$ определяется следующим выражением:
\begin{equation*}
    C = W^{-1}B^T(BW^{-1}B^T)^{-1}
\end{equation*}

Это решение возможно только если матрица $B$ является невырожденной, но зачастую, это не так или она может стать вырожденной при отказах отдельных элементов движительно-рулевого комплекса. В этом случае в практической реализации нормальной является практика записи матрицы $C$ в следующей форме:
\begin{equation}
    \label{eq:allocation_unbound}
    C_{\epsilon} = W^{-1} B^T (BW^{-1}B^T + \epsilon I)^{-1}
\end{equation}
\noindent где $\epsilon \geq 0$ представляет собой бесконечно малую добавку фактически не влияющую на решение задачи, но обеспечивающую существование обратной матрицы.

\subsubsection{Прямое управление ДРК с масштабированием} \label{sssec:AllocationFix}
Данный подход не обеспечивает оптимального решения, но позволяет получить его в условиях линейных ограничений $\vect{u} \in \mathspace{U} \subset \mathspace{R}^k$ накладываемых на исполнительные механизмы.
Данный метод подразумевает поиск такого набора линейных положительных сжимающих коэффициентов $\vect{\alpha} \in [0,1]$, при котором решение задачи управления ДРК не выходит за рамки допустимого множества $\mathspace{U}$ \cite{durham1993constrained}, при этом новая линейная оптимизационная задача ставится следующим образом:
\begin{gather*}
    \max \vect{\alpha} \\
    \text{при условии } B\vect{u} = \vect{\alpha} \vect{\nu_c}, \vect{\alpha} \vect{\nu_c} \in \mathspace{A}
\end{gather*}

Решение задачи поиска такого набора сжимающих коэффициентов встречается в зарубежной литературе \cite{bordingnon1995closed, petersen2002fast}.

Одна из вариаций данного подхода, которая используется в аппаратах Института проблем морских технологий ДВО РАН формулируется следующим образом \cite{костенко2015вопросу}.
Пусть $\nu_c^{prio}$ представляет собой команду управления $\nu_c$ в которой оси расставлены в соответствии с уменьшением степени приоритета, $l=[l_1,l_2, \ldots, l_m]$ где $l_i \in [0,1]$ представляет собой набор коэффициентов насыщения $i$-ой оси управления, а $u^{ub}$ представляет собой решение задачи управления ДРК без ограничений, полученное в соответствии с выражением \ref{eq:allocation_unbound}. Тогда можно решить задачу управления ДРК итерационным методом с фиксированным количеством шагов. Так для оси с максимальным приоритетом, т.е. для $v_c^1$ сжимающий коэффициент будет записан следующим образом:
\begin{equation*}
    \alpha_1 = \min \left\{ \frac{l_1 \cdot u_j^{lim}}{u_j^{ub}} \right\}_{j=1}^k
\end{equation*}
\noindent где $u_j^{lim}$ представляет собой максимальное значение команды управления $j$-го исполнительного механизма. Для простоты, считаем что характеристика исполнительного механизма симметрична, т.е. $u_j^{lim} = u_j^+ = u_j^-$

Для осей с меньшим приоритетом, т.е. для $i>1$ в наборе $\nu_c^{prio}$, расчёт сжимающего коэффициента будет записан следующим образом:
\begin{equation*}
    \alpha_i = \min \left\{ \frac{\min (l_1 \cdot u_j^{lim}, u_j^{lim} - u_j^{prev})}{u_j^{ub}} \right\}_{j=1}^k
\end{equation*}
\noindent где $u_j^{prev}$ представляет собой команду управления, которая была рассчитана для $j$-го исполнительного механизма на предыдущих итерациях алгоритма расчёта и определяется следующим образом:
\begin{equation*}
    u_j^{prev} = \sum_{k=0}^{i-1} \alpha_k u_k^{ub}
\end{equation*}

\subsubsection{Квадратичная оптимизация}
Выбором функционала второго порядка в уравнении описывающем управляемую систему \ref{eq:dynamic_statespace_new} можно легко привести к записи задачи квадратичной оптимизации в каноничной форме (метрика $L_2$ или евклидова норма):
\begin{equation*}
    \min_{u,s} \frac{1}{2}\left(\vect{u^T}, \vect{s^T}\right) H 
    \begin{pmatrix}
        \vect{u} \\
        \vect{s}
    \end{pmatrix}
\end{equation*}
\noindent где $H = 2 \cdot diag(q_1,\ldots,q_k, w_1,\ldots,w_m)$ представляет собой диагональную матрицу положительно определённых весовых коэффициентов для ИМ ДРК ($q_1,\ldots,q_k$) и элементов вектора виртуального управления ($w_1,\ldots,w_m$).

В данной постановке задачи используются различные математические методы поиска решения, например, метод активного набора (active set) или метод внутренней точки (interior point).
Оба метода использовались при квадратичной формулировки задачи управления ДРК \cite{petersen2005constrained, harkegard2002efficient}.
Функционал $J$ может быть записан также и в $L_1$ метрике, но особенностью методов линейного программирования при решении таких задач является поиск оптимального решения по граням и вершинам области допустимых значений границ подмножества $\mathspace{U}$. 
Физический смысл этого заключается в тенденции максимальной загрузки минимального количества ИМ \cite{bodson2002evaluation}, что существенно уменьшает КПД электропривода, повышает износ отдельных ИМ и ведёт к чрезмерной нагрузке на систему энергообеспечения. В то время как методы квадратичного программирования, в свою очередь, стремятся найти такое решение, которое распределяет равную нагрузку на максимальное количество элементов управления.

\section{Постановка цели и задач исследования}\label{sec:Statement/SetProblems}

Задачу управления движением подводного аппарата можно ставить различными способами.
Один из них заключается в разделении задачи на две независимых, которые решаются последовательно: управление движением НПА и управление исполнительными механизмами.
Показано \cite{10.1016/j.automatica.2004.09.007}, что при такой декомпозиции управления оптимальность решения сохраняется.
В главе приведены различные подходы и методы решения задачи управления ДРК в зависимости от его типа.
Кроме того, представлены программные пакеты, которые позволяют реализовать рассмотренные подходы в компьютерах и встраиваемых системах. 

Описываемая задача представляется достаточно проработанной, но в то же время существует большой пласт особенностей ИМ, которые до сих пор не учтены в представленных подходах:
\begin{itemize}
    \item при формировании моделей исполнительных механизмов явным образом не выражены параметры электроприводов. В работах не учитывается, что коэффициент полезного действия электромотора существенно зависит от скорости вращения вала привода;
    \item модель ИМ не учитывает сильную зависимость параметров исполнительных механизмов от скорости набегающего потока, хотя это важный параметр для работы всех исполнительных механизмов. Так например в работе \cite{palmer2008modelling} показано что из-за гидродинамических особенностей эффективность подруливающего движителя существенно падает с возрастанием скорости поперечного набегающего потока.
\end{itemize}

\textbf{Целью диссертационной работы} является разработка методов энергоэффективного и отказоустойчивого управления избыточным движительно-рулевым комплексом подводного аппарата с учётом динамики исполнительных механизмов и их гидродинамических особенностей.

Для~достижения поставленной цели необходимо было решить следующие {\tasks}:
\begin{enumerate}[beginpenalty=10000] % https://tex.stackexchange.com/a/476052/104425
  \item Изучить модели описания исполнительных механизмов (маршевые движители, подруливающие движители, рули управления) ДРК подводного аппарата учитывающие особенности их работы в набегающем потоке;
  \item Разработать и реализовать метод оценки скорости движения ПА относительно набегающего потока по параметрам работы электроприводов маршевых движителей;
  \item Разработать и реализовать энергетически оптимальный метод управления ДРК для АНПА адаптивный к различным типам движения ПА;
  \item Провести проверку эффективности разработанного метода управления ДРК на базе модельных экспериментов.
\end{enumerate}

\section{Выводы по главе 1}\label{sec:Statement/Conclusion}
В первой главе приведен обзор современных методов и подходов к решению задачи энергоэффективного управления ДРК.

Отмечено, что хоть тема достаточно проработана, но в работах почти никак не фигурируют гидродинамические особенности работы исполнительных механизмов в набегающем потоке и уменьшение их результирующей силы, что будет детально рассмотрено в следующих главах работы.

На основе проведенного анализа сформулированы цель и поставлены задачи диссертационного исследования.